---
import { getCollection } from "astro:content";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { NestedAccordion } from "@/components/lists/NestedAccordion";

const top5 = await getCollection("top5");

const categorySections = top5.map((entry) => ({
  category: entry.data.category,
  subcategories: entry.data.subcategories,
}));
---

<div class="flex-col-standard gap-8">
  <h3>All-Time Top 5</h3>

  {
    categorySections.map(({ category, subcategories }) => (
      <div class="flex-col-standard gap-2">
        <h5>{category}</h5>

        <Card className="w-full">
          <CardContent className="-mt-4 -mb-5">
            <NestedAccordion
              client:load
              data={subcategories}
            />
          </CardContent>
        </Card>
      </div>
    ))
  }
</div>
